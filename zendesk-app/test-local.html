<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆ - é¡§å®¢ãƒªã‚¹ã‚¯åˆ†æ</title>
  <link rel="stylesheet" href="assets/styles.css">
  <style>
    body {
      padding: 20px;
      background: #f5f5f5;
    }
    .test-container {
      max-width: 400px;
      margin: 0 auto;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .test-info {
      background: #e3f2fd;
      padding: 10px;
      border-radius: 4px;
      margin-bottom: 20px;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <div class="test-container">
    <div class="test-info">
      <strong>ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰</strong><br>
      ã“ã®ãƒšãƒ¼ã‚¸ã¯Zendeskç’°å¢ƒå¤–ã§ã®ãƒ†ã‚¹ãƒˆç”¨ã§ã™ã€‚<br>
      å®Ÿéš›ã®å‹•ä½œç¢ºèªã¯Zendeskã‚¢ãƒ—ãƒªã¨ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚
    </div>
    
    <div id="app-root">
      <div id="app">
        <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° -->
        <div id="loading" class="loading">
          <div class="spinner"></div>
          <p>èª­ã¿è¾¼ã¿ä¸­...</p>
        </div>

        <!-- ã‚¨ãƒ©ãƒ¼è¡¨ç¤º -->
        <div id="error" class="error-message" style="display: none;"></div>

        <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
        <div id="content" style="display: none;">
        
        <!-- è¦ç´„ãƒœã‚¿ãƒ³ï¼ˆä¸Šéƒ¨å›ºå®šï¼‰ -->
        <div class="summary-button-top sticky">
          <button id="summarize-btn-top" class="btn-primary">
            ğŸ“ è¦ç´„ã™ã‚‹
          </button>
        </div>

        <!-- è¦ç´„çµæœã‚¨ãƒªã‚¢ï¼ˆLINEé¢¨ãƒãƒ£ãƒƒãƒˆï¼‰ -->
        <div id="summary-container" class="summary-container" style="display: none;">
          <div class="summary-header">
            <h3>ğŸ“‹ AIè¦ç´„</h3>
            <button id="close-summary" class="btn-close">Ã—</button>
          </div>
          <div id="summary-content" class="chat-container"></div>
        </div>

        <!-- é¡§å®¢ãƒªã‚¹ã‚¯æŒ‡æ¨™ -->
        <div id="customer-risk" class="risk-panel">
          <h3>âš ï¸ é¡§å®¢ãƒªã‚¹ã‚¯æŒ‡æ¨™</h3>
          <div class="risk-meter">
            <div id="risk-level" class="risk-level">é€šå¸¸</div>
            <div class="risk-bar">
              <div id="risk-bar-fill" class="risk-bar-fill" style="width: 0%"></div>
            </div>
            <div id="risk-score" class="risk-score">0</div>
          </div>
          <div id="risk-details" class="risk-details"></div>
        </div>

        <!-- ãƒã‚±ãƒƒãƒˆå±¥æ­´ä¸€è¦§ -->
        <div id="ticket-history" class="ticket-history">
          <h3>ğŸ“œ éå»ã®å•ã„åˆã‚ã›å±¥æ­´</h3>
          <div id="ticket-list" class="ticket-list"></div>
          <div id="no-tickets" class="no-tickets" style="display: none;">
            éå»ã®ãƒã‚±ãƒƒãƒˆã¯ã‚ã‚Šã¾ã›ã‚“
          </div>
        </div>

        <!-- è¦ç´„ãƒœã‚¿ãƒ³ï¼ˆä¸‹éƒ¨ï¼‰ -->
        <div class="summary-button-bottom">
          <button id="summarize-btn-bottom" class="btn-primary">
            ğŸ“ è¦ç´„ã™ã‚‹
          </button>
        </div>

        <!-- è¦æ³¨æ„ãƒ¡ãƒ¢ -->
        <div id="alert-memo" class="alert-memo">
          <h3>âš¡ è¦æ³¨æ„ãƒ¡ãƒ¢</h3>
          <div id="existing-memos" class="existing-memos"></div>
          <textarea id="memo-input" class="memo-input" placeholder="ã“ã®é¡§å®¢ã«é–¢ã™ã‚‹æ³¨æ„äº‹é …ã‚’å…¥åŠ›..."></textarea>
          <button id="save-memo-btn" class="btn-secondary">ğŸ’¾ ãƒ¡ãƒ¢ã‚’ä¿å­˜</button>
        </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- ZAF SDKã®ãƒ¢ãƒƒã‚¯ -->
  <script>
    // ZAFClientã®ãƒ¢ãƒƒã‚¯å®Ÿè£…
    window.ZAFClient = {
      init: function() {
        console.log('Mock ZAFClient initialized');
        return {
          get: async function(key) {
            console.log('Mock get:', key);
            if (key === 'currentUser') {
              return { 'currentUser': { id: 1, name: 'Test User' } };
            }
            if (key === 'ticket.requester') {
              return { 
                'ticket.requester': { 
                  id: 123, 
                  email: 'test@example.com',
                  name: 'ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼'
                } 
              };
            }
            if (key === 'ticket.id') {
              return { 'ticket.id': 999 };
            }
            return {};
          },
          metadata: async function() {
            return {
              settings: {
                api_endpoint: 'https://example.com/api',
                api_key: 'test-key'
              }
            };
          },
          request: async function(options) {
            console.log('Mock request:', options);
            // ãƒ¢ãƒƒã‚¯ãƒã‚±ãƒƒãƒˆãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã™
            return {
              results: [
                {
                  id: 1,
                  subject: 'å•†å“ãŒå±Šã‹ãªã„',
                  description: 'æ³¨æ–‡ã—ãŸå•†å“ãŒ1é€±é–“çµŒã£ã¦ã‚‚å±Šãã¾ã›ã‚“',
                  status: 'solved',
                  created_at: '2024-02-10T10:00:00Z',
                  updated_at: '2024-02-11T15:00:00Z',
                  requester_id: 123
                },
                {
                  id: 2,
                  subject: 'è¿”é‡‘ã«ã¤ã„ã¦',
                  description: 'è¿”é‡‘ã‚’ãŠé¡˜ã„ã—ãŸã„ã§ã™',
                  status: 'open',
                  created_at: '2024-02-15T14:30:00Z',
                  updated_at: '2024-02-15T14:30:00Z',
                  requester_id: 123
                },
                {
                  id: 3,
                  subject: 'ä½¿ã„æ–¹ãŒã‚ã‹ã‚‰ãªã„',
                  description: 'è£½å“ã®ä½¿ã„æ–¹ã‚’æ•™ãˆã¦ãã ã•ã„',
                  status: 'solved',
                  created_at: '2024-01-20T09:00:00Z',
                  updated_at: '2024-01-21T10:00:00Z',
                  requester_id: 123
                }
              ]
            };
          },
          invoke: function(method, data) {
            console.log('Mock invoke:', method, data);
            return Promise.resolve();
          }
        };
      }
    };
  </script>
  <script src="assets/main.js"></script>
</body>
</html>
